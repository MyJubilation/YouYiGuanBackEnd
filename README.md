# YouYiGuanBackEnd

## 该仓库负责油医馆项目后端文件

# 主要功能：

---

## 注册
注册部分分为四个接口：请求验证码，验证验证码，人脸检测与医生注册信息输入
### 请求验证码
接收手机号，通过Kapcha提供的方法生成四位数验证码，并存储到redis中，TTL15分钟。  
发送验证码给对应手机功能需要在线api调用，所以未实现。  
### 验证验证码
接收手机号与用户输入验证码，通过手机号和验证码对比数据库数据，如果对比成功则登录  
### 人脸检测
通过调用阿里云的api接口，接收用户传来的img文件，检测人脸并接收返回的face_token，将token存储到对应数据库中  
### 医生注册信息输入
接收医生信息，并进行判断，如果合法则存储进数据库中

---

## 医生登录接口

### 用户名密码登录
接收前端传来的用户名密码，与数据库中的数据进行比对
### 人脸识别登录
接收前端传来的人脸图片，通过调用人脸检测api获取face_token，再将face_token与数据库中的进行比对，如果相同则登录成功
### 手机号验证码登录
同注册功能验证码

---

## 医生个人中心

### 获取医生个人信息
调用该接口返回医生数据库表中的信息
### 修改医生个人信息
根据前端传来的数据对数据库的医生信息进行修改
### 修改登录密码
通过前端传来的原始密码与数据库中的密码进行比对，如果正确则修改为新密码
### 查看权限信息
通过jwt获取username，查看对应医生权限信息

---

## 病人管理

### 获取病人列表
调用该接口返回病人的List列表
### 病人详细信息
通过前端传来的数据，获取对应病人的信息并返回
### 获取指定病人诊断记录
### 医生确认预约病更新数据库
根据 appointment_id 更新 patientappointment 表：  
status 从 “待确认” 更新为 “待诊断”。  
自动在 medicalrecord 表中创建对应的诊疗记录：  
新记录包含病人的 ID (patient_id)、医生 ID (doctor_id)、当前日期作为 visit_date，以及默认值（如 review_status = '待审核'）。
返回更新后的预约记录和新创建的诊疗记录详情。
### 医生为病人诊断
医生为病人输入舌苔、脉象等诊断信息，并更新病人的症状、身高和体重等基础信息
### 修改诊断记录
### 智能推荐药方
通过外部api调用，输入症状，返回对应推荐药方

---

## 处方管理

### 查看处方列表
### 新建处方
### 修改处方
### 删除处方

---

## 医生通知与提醒

### 获取医生通知列表
### 标记通知为已读
### 清空所有通知
### 创建通知
### 获取未读通知数量


---

# Result通用返回
使用链式编程，对返回前端的数据进行规范化处理

---

# config配置类

## KapchaConfig
配置Kapcha生成验证码种类（全数字），长度（4位）
## PaginationConfig
配置分页查询
## 其他
其他请自行查看